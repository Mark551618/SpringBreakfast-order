<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>早餐店點餐系統</title>
    <style>
        body {
            background-image: url("/flowerPic.jpg"); /* 使用根目錄方式存取 */
            background-size: cover; /* 讓背景填滿整個畫面 */
            background-position: center; /* 讓圖片保持在畫面中央 */
            background-repeat: no-repeat; /* 避免圖片重複 */
            text-align: center; /*文字置中*/
            height: 100vh; /* 讓背景至少滿版 */
            font-family: "Times New Roman", Arial, serif; /* 設定字體優先度 */
            font-size: 22px; /*字體大小*/
            padding-bottom: 100px;
        }

        .menu-container {
            width: fit-content;       /* 讓寬度剛好包住內容 */
            margin: 0 auto;           /*  重點：讓區塊置中 */
            text-align: left;
        }
        .menu-container > div {
            display: flex;
            align-items: center; /* 垂直置中對齊所有按鈕和文字 */
            margin-bottom: 8px;
            justify-content: flex-start;
        }

        .menu-container span:first-child {
            width: 300px; /*  固定寬度或用 max-width 控制 */
            display: inline-block;
        }


        #orderIdInput {
            border-style: solid;/*外框風格 實心黑線*/
            font-family: "Times New Roman", Arial, serif; /* 設定字體 */
            font-size: 22px;
        }
        .btn {
            cursor: pointer;
            font-size: 22px;
        }

        .add {
            background-color: rgba(41, 145, 23, 0.93);
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .reduce {
            background-color: #ff748b;
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

    </style>
    <script>
        let cart = {
            1: 0, 2: 0, 3: 0,
            4: 0, 5: 0, 6: 0,
            7: 0, 8: 0, 9: 0
        };

        function updateQuantity(productId, change) {
            cart[productId] += change;
            if (cart[productId] < 0) cart[productId] = 0;
            document.getElementById(`qty-${productId}`).textContent = cart[productId];
        }

        function submitOrder() {
            const tableNumber = prompt("請輸入桌號，例如 A1：");
            if (!tableNumber) return;

            const items = [];
            for (const [productId, quantity] of Object.entries(cart)) {
                if (quantity > 0) {
                    items.push({
                        productId: parseInt(productId),
                        quantity: quantity
                    });
                }
            }

            if (items.length === 0) {
                alert("尚未選擇任何餐點！");
                return;
            }

            const order = {
                tableNumber: tableNumber,
                items: items
            };

            fetch("/orders", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(order)
            }).then(res => {
                if (res.ok) {
                    alert("訂單送出成功！");
                    location.reload();
                } else {
                    alert("訂單送出失敗！");
                }
            });
        }

        function queryOrderMain() {
            fetch("/orders/main")
                .then(res => res.json())
                .then(data => {
                    document.getElementById("queryResult").textContent = JSON.stringify(data, null, 2);
                })
                .catch(err => {
                    document.getElementById("queryResult").textContent = "查詢失敗: " + err;
                });
        }

        function queryOrderItems() {
            const orderId = document.getElementById("orderIdInput").value;
            if (!orderId) {
                alert("請輸入訂單編號！");
                return;
            }

            fetch(`/orders/${orderId}/items`)
                .then(res => {
                    if (!res.ok) {
                        throw new Error(`錯誤碼 ${res.status}`);
                    }
                    return res.json();
                })
                .then(data => {
                    document.getElementById("queryResult").textContent = JSON.stringify(data, null, 2);
                })
                .catch(err => {
                    document.getElementById("queryResult").textContent = "查詢失敗: " + err;
                });
        }
    </script>
</head>
<body>
<h1>早餐店點餐系統</h1>
<div class="menu-container">
    <div><span>1. 火腿漢堡 50元</span>
        <button class="reduce" onclick="updateQuantity(1, -1)">-</button>
        <span id="qty-1">0</span>
        <button class="add" onclick="updateQuantity(1, 1)">+</button>
    </div>

    <div><span>2. 燻雞漢堡 45元</span>
        <button class="reduce" onclick="updateQuantity(2, -1)">-</button>
        <span id="qty-2">0</span>
        <button class="add" onclick="updateQuantity(2, 1)">+</button>
    </div>

    <div><span>3. 日式雞排漢堡 65元</span>
        <button class="reduce" onclick="updateQuantity(3, -1)">-</button>
        <span id="qty-3">0</span>
        <button class="add" onclick="updateQuantity(3, 1)">+</button>
    </div>

    <div><span>4. 熱狗蛋餅 40元</span>
        <button class="reduce" onclick="updateQuantity(4, -1)">-</button>
        <span id="qty-4">0</span>
        <button class="add" onclick="updateQuantity(4, 1)">+</button>
    </div>

    <div><span>5. 原味蛋餅 30元</span>
        <button class="reduce" onclick="updateQuantity(5, -1)">-</button>
        <span id="qty-5">0</span>
        <button class="add" onclick="updateQuantity(5, 1)">+</button>
    </div>

    <div><span>6. 培根蛋餅 45元</span>
        <button class="reduce" onclick="updateQuantity(6, -1)">-</button>
        <span id="qty-6">0</span>
        <button class="add" onclick="updateQuantity(6, 1)">+</button>
    </div>

    <div><span>7. 奶茶 30元</span>
        <button class="reduce" onclick="updateQuantity(7, -1)">-</button>
        <span id="qty-7">0</span>
        <button class="add" onclick="updateQuantity(7, 1)">+</button>
    </div>

    <div><span>8. 紅茶 20元</span>
        <button class="reduce" onclick="updateQuantity(8, -1)">-</button>
        <span id="qty-8">0</span>
        <button class="add" onclick="updateQuantity(8, 1)">+</button>
    </div>

    <div><span>9. 豆漿 20元</span>
        <button class="reduce" onclick="updateQuantity(9, -1)">-</button>
        <span id="qty-9">0</span>
        <button class="add" onclick="updateQuantity(9, 1)">+</button>
    </div>
</div>
<br>
<button class="btn" onclick="submitOrder()">送出訂單</button>

<hr>

<h2>訂單查詢功能</h2>

<!-- 查詢訂單主表 -->
<button class="btn" onclick="queryOrderMain()">查詢訂單總表</button>

<!-- 輸入訂單編號並查詢 -->
<label for="orderIdInput">訂單編號：</label>
<input type="number" id="orderIdInput" placeholder="請輸入訂單編號">
<button class="btn" onclick="queryOrderItems()">查詢訂單明細</button>

<pre id="queryResult"></pre>



</body>
</html>